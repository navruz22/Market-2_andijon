"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1968],{602:function(e,t,r){var i=r(71),a=r(184);t.Z=function(e){var t=e.id,r=e.title,n=e.code,o=e.products,c=e.activeCategory,l=e.onClick;return(0,a.jsxs)("div",{className:"category-card ".concat(c?"active-category":""),onClick:function(){return l(t)},children:[(0,a.jsx)("h1",{className:"text-black-700 text-base leading-[1.5625rem]",children:r||"Nomsiz kategoriya"}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,a.jsx)("p",{className:"footer-text",children:"Kodi :"}),(0,a.jsx)("span",{className:"block rounded-[3.125rem] bg-warning-500 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:n||0})]}),(0,a.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,a.jsx)("p",{className:"footer-text",children:"Maxsulot turlari :"}),(0,a.jsx)("span",{className:"block rounded-[3.125rem] bg-success-400 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:o||0})]})]}),(0,a.jsx)("div",{className:"category-card-checkmark",children:(0,a.jsx)(i.jI1,{size:"1rem",className:"check-icon"})})]})}},5668:function(e,t,r){var i=(0,r(1608).ZP)("http://45.81.227.123/"),a=JSON.parse(localStorage.getItem("userData"));i.auth={token:a.token,market:a.market},t.Z=i},2724:function(e,t,r){r.r(t);var i=r(4942),a=r(1413),n=r(3433),o=r(9439),c=r(2791),l=r(8063),u=r(4339),d=r(9434),s=r(2594),p=r(4232),m=r(763),v=r(602),f=r(1295),g=r(71),x=r(3168),h=r(5023),b=r(5668),Z=r(2106),y=r(8732),j=r(7584),N=r(2230),_=r(7689),k=r(8679),w=r(184);t.default=function(){var e=(0,x.$)(["common"]).t,t=(0,d.I0)(),r=(0,_.TH)(),z=(0,_.s0)(),P=(0,d.v9)((function(e){return e.currency})),C=P.currencyType,S=P.currency,M=(0,d.v9)((function(e){return e.connections})),q=M.connections,I=M.loading,T=(0,d.v9)((function(e){return e.login})).market,U=(0,d.v9)((function(e){return e.registerOrders})),Y=U.categoriesPartner,E=U.allProductsPartner,O=(0,c.useState)(),A=(0,o.Z)(O,2),B=A[0],J=A[1],D=(0,c.useState)(null),K=(0,o.Z)(D,2),L=K[0],Q=K[1],H=(0,c.useState)(Y),F=(0,o.Z)(H,2),V=F[0],$=F[1],G=(0,c.useState)([]),R=(0,o.Z)(G,2),W=R[0],X=R[1],ee=(0,c.useState)(null),te=(0,o.Z)(ee,2),re=te[0],ie=te[1],ae=(0,c.useState)(""),ne=(0,o.Z)(ae,2),oe=ne[0],ce=ne[1],le=(0,c.useState)([]),ue=(0,o.Z)(le,2),de=ue[0],se=ue[1],pe=(0,c.useState)(""),me=(0,o.Z)(pe,2),ve=me[0],fe=me[1],ge=(0,c.useState)(!1),xe=(0,o.Z)(ge,2),he=xe[0],be=xe[1],Ze=(0,c.useState)(null),ye=(0,o.Z)(Ze,2),je=ye[0],Ne=ye[1],_e=(0,c.useState)(null),ke=(0,o.Z)(_e,2),we=ke[0],ze=ke[1],Pe=(0,c.useState)(null),Ce=(0,o.Z)(Pe,2),Se=Ce[0],Me=Ce[1],qe=(0,c.useState)("recived"),Ie=(0,o.Z)(qe,2),Te=Ie[0],Ue=Ie[1],Ye=(0,c.useState)("orderProducts"),Ee=(0,o.Z)(Ye,2),Oe=Ee[0],Ae=Ee[1],Be=function(e){re===e?ie(null):(ie(e),ce(""),$(Y))},Je=function(){se([]),Q(null)};return(0,c.useEffect)((function(){var e=[],r=[];T&&L&&(b.Z.emit("getPartnerProducts",{market:T._id,partner:L.value}),b.Z.on("partnerCategories",(function(e){var r=e.id,i=e.categories;r===T._id&&(t((0,y.Aw)(i)),$(i))})),b.Z.on("setPartnerProducts",(function(i){var a=i.id,o=i.products;a===T._id&&(r=[].concat((0,n.Z)(r),(0,n.Z)((0,m.map)(o,(function(e){return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}})))),X(r),e.push.apply(e,(0,n.Z)(o)),t((0,y.CB)(e)))})),b.Z.on("error",(function(e){var t=e.id,r=e.message;t===T._id&&(0,Z.Ug)(r,"error")})))}),[T,t,L]),(0,c.useEffect)((function(){t((0,h.JL)())}),[t]),(0,c.useEffect)((function(){if(re){var e=(0,m.filter)(E,(function(e){return e.category._id===re}));X((0,m.map)(e,(function(e){return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}})))}else X((0,m.map)(E,(function(e){return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}})))}),[re,E]),(0,c.useEffect)((function(){var e=(0,m.map)(q,(function(e){return{label:(null===e||void 0===e?void 0:e.name)+" - "+(null===e||void 0===e?void 0:e.inn),value:e._id}}));J(e)}),[q]),(0,c.useEffect)((function(){var e,t=r.state;t&&t.temporary&&(Ne(t),se(null===t||void 0===t?void 0:t.temporary.tableProducts),Q(null===t||void 0===t||null===(e=t.temporary)||void 0===e?void 0:e.partner));if(t&&t.order){"requested"===t.position&&(Ue("recived"),Ae("orderProducts")),"delivered"===t.position&&(Ue("delivered"),Ae("receiveOrderProducts")),Me(t.order),Q({label:t.order.sender.name+" - "+t.order.sender.inn,value:t.order.sender._id});var i=(0,m.map)(t.order.products,(function(e){var t,r,i,n,o,c,l,u,d,s,p;return{_id:e._id,sender:e.sender,product:{_id:null===(t=e.product)||void 0===t?void 0:t._id,code:null===(r=e.product)||void 0===r||null===(i=r.productdata)||void 0===i?void 0:i.code,name:null===(n=e.product)||void 0===n||null===(o=n.productdata)||void 0===o?void 0:o.name,barcode:null===(c=e.product)||void 0===c||null===(l=c.productdata)||void 0===l?void 0:l.barcode},productdata:null===(u=e.product)||void 0===u?void 0:u.productdata._id,category:null===e||void 0===e||null===(d=e.product)||void 0===d?void 0:d.category._id,totalprice:null===e||void 0===e?void 0:e.totalprice,totalpriceuzs:e.totalpriceuzs,pieces:(0,a.Z)({},null===e||void 0===e?void 0:e.pieces),total:null===e||void 0===e||null===(s=e.product)||void 0===s?void 0:s.total,unitprice:null===e||void 0===e?void 0:e.unitprice,unitpriceuzs:null===e||void 0===e?void 0:e.unitpriceuzs,unit:null===e||void 0===e||null===(p=e.product)||void 0===p?void 0:p.unit}}));se(i)}window.history.replaceState({},document.title)}),[r.state]),(0,w.jsxs)("section",{className:"flex grow relative overflow-auto",children:[(0,w.jsx)(N.Z,{body:ve,isOpen:he,headerText:"complete"===ve?"Buyurtma uchun so'rov yuborishni tasdiqlaysizmi?":"",toggleModal:function(){be(!1),setTimeout((function(){fe("")}),500)},approveFunction:function(){if(de.length>0){var r={partner:L.value,products:de,orderId:Se?Se._id:null};t("delivered"===Te?(0,y.zg)(r):Se?(0,y.Cs)(r):(0,y.LV)(r)).then((function(e){var r=e.error,i=e.payload;r||(Se&&Me(null),ze(i),setTimeout((function(){fe("checkOrder"),be(!0),Je()}),500),je&&(t((0,k.A8)({temporaryId:je._id})),Ne(null)))}))}else(0,Z.Ug)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},order:we}),(0,w.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem] overflow-auto",children:[(0,w.jsxs)("div",{className:"mainPadding flex flex gap-[1.25rem]",children:[(0,w.jsx)(l.Z,{select:!0,placeholder:"misol: Alo24",value:L||"",label:"Do`kon nomi",onChange:function(e){return Q(e)},options:B,border:!0,disabled:"delivered"===Te}),(0,w.jsx)(l.Z,{disabled:!L||"delivered"===Te,select:!0,placeholder:"misol: kompyuter",value:"",label:"Maxsulotlar",onChange:function(t){if(t.barcode?(0,m.filter)(de,(function(e){return e.product.barcode===t.barcode})).length>0:(0,m.filter)(de,(function(e){return e.product._id===t.value})).length>0)(0,Z.Ug)(e("Maxsulot ro'yxatda mavjud !"),"error");else{var r=t.barcode?E.find((function(e){return e.productdata.barcode===t.barcode})):E.find((function(e){return e._id===t.value})),i={sender:L.value,product:{_id:r._id,code:r.productdata.code,name:r.productdata.name,barcode:r.productdata.barcode},productdata:r.productdata._id,category:r.category._id,totalprice:r.price.sellingprice,totalpriceuzs:r.price.sellingpriceuzs,pieces:{recived:1},total:r.total,unitprice:r.price.sellingprice,unitpriceuzs:r.price.sellingpriceuzs,unit:r.unit};se([].concat((0,n.Z)(de),[i]))}},options:W})]}),(0,w.jsx)("div",{className:"tableContainerPadding",children:de.length?(0,w.jsx)(u.Z,{page:Oe,data:de,headers:{recived:[{title:"\u2116"},{title:"Maxsulot kodi"},{title:"Maxsulot nomi"},{title:"Maxsulot soni"},{title:"Maxsulot narxi"},{title:"Soni"},{title:"Jami"},{title:""}],delivered:[{title:"\u2116"},{title:"Maxsulot kodi"},{title:"Maxsulot nomi"},{title:"So'ralgan"},{title:"Yuborilgan"},{title:"Qabul qilinayotgan"},{title:"Narxi"},{title:"Jami"}]}[Te],currency:C,increment:function(e){var t=(0,m.map)(de,(function(t){return t.product._id===e?(0,a.Z)((0,a.Z)({},t),{},{pieces:(0,a.Z)((0,a.Z)({},t.pieces),{},(0,i.Z)({},Te,Number(t.pieces[Te])+1)),totalprice:(0,j.Y2)((Number(t.pieces[Te])+1)*t.unitprice),totalpriceuzs:(0,j.ei)((Number(t.pieces[Te])+1)*t.unitpriceuzs)}):t}));se(t)},decrement:function(e){var t=(0,m.map)(de,(function(t){return t.product._id===e?(0,a.Z)((0,a.Z)({},t),{},{pieces:(0,a.Z)((0,a.Z)({},t.pieces),{},(0,i.Z)({},Te,Number(t.pieces[Te])>0?Number(t.pieces[Te])-1:0)),totalprice:(0,j.Y2)((Number(t.pieces[Te])>0?Number(t.pieces[Te])-1:0)*t.unitprice),totalpriceuzs:(0,j.ei)((Number(t.pieces[Te])>0?Number(t.pieces[Te])-1:0)*t.unitpriceuzs)}):t}));se(t)},handleDelete:function(e){de.splice(e,1),se((0,n.Z)(de))},footer:"registersale",handleCountProduct:function(e,t){var r=Number(e.target.value),n=(0,m.map)(de,(function(e){return e.product._id===t?(0,a.Z)((0,a.Z)({},e),{},{pieces:(0,a.Z)((0,a.Z)({},e.pieces),{},(0,i.Z)({},Te,r)),totalprice:(0,j.Y2)(r*e.unitprice),totalpriceuzs:(0,j.ei)(r*e.unitpriceuzs)}):e}));se(n)}}):(0,w.jsx)(f.Z,{text:e("Buyurtmaga mahsulotlar qo'shilmagan!")})})]}),(0,w.jsxs)("div",{className:"register-selling-right min-w-[20.25rem] bg-white-400 backdrop-blur-[3.125rem] rounded-[0.25rem] flex flex-col gap-[1.25rem]",children:[(0,w.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem]",children:[(0,w.jsx)(s.Z,{placeholder:e("kategoriyani qidirish..."),value:oe,onChange:function(e){var t=e.target.value;ce(t);var r=t.replace(/\s+/g," ").trim(),i=(0,m.filter)(Y,(function(e){return e.name&&e.name.toLowerCase().includes(r)||e.code.includes(r)}));$(""!==t?i:Y)},onKeyUp:function(){}}),(0,w.jsx)("div",{className:"grow relative overflow-auto",children:(0,w.jsx)("div",{className:"cards-container absolute left-0 right-[0.125rem] top-0 bottom-0",children:I?(0,w.jsx)("div",{className:"tableContainerPadding",children:(0,w.jsx)(p.Z,{})}):V.length>0?(0,m.map)(V,(function(e){return(0,w.jsx)(v.Z,{id:e._id,activeCategory:e._id===re,title:e.name,code:e.code,products:e.products.length,onClick:Be},e._id)})):(0,w.jsx)(f.Z,{text:e("Kategoriya mavjud emas")})})})]}),(0,w.jsxs)("div",{className:"flex gap-[0.625rem]",children:[(0,w.jsx)("button",{type:"button",className:"register-selling-right-accept-btn",onClick:function(){de.length?(be(!0),fe("complete")):S?(0,Z._P)():(0,Z.YQ)()},children:e("delivered"===Te?"Qabul qilish":"Buyurtma berish")}),"delivered"!==Te&&(0,w.jsx)("button",{type:"button",onClick:function(){if(de.length>0){var r=de.reduce((function(e,t){return(0,j.Y2)(e+t.totalprice)}),0),i=de.reduce((function(e,t){return(0,j.ei)(e+t.totalpriceuzs)}),0),a={temporary:{partner:L,tableProducts:de,totalPrice:r,totalPriceUzs:i}};t((0,k.H6)(a)).then((function(e){e.error||(Je(),z("/dukonlar/buyurtma_berish/saqlanganlar"))})),je&&(t((0,k.A8)({temporaryId:je._id})),Ne(null))}else(0,Z.Ug)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},className:"register-selling-right-deny-btn",children:(0,w.jsx)(g.T24,{size:"1.5rem"})})]})]})]})}}}]);
//# sourceMappingURL=1968.1bf9fa3b.chunk.js.map