"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7458],{602:function(e,t,a){var n=a(71),r=a(184);t.Z=function(e){var t=e.id,a=e.title,i=e.code,c=e.products,l=e.activeCategory,u=e.onClick;return(0,r.jsxs)("div",{className:"category-card ".concat(l?"active-category":""),onClick:function(){return u(t)},children:[(0,r.jsx)("h1",{className:"text-black-700 text-base leading-[1.5625rem]",children:a||"Nomsiz kategoriya"}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,r.jsx)("p",{className:"footer-text",children:"Kodi :"}),(0,r.jsx)("span",{className:"block rounded-[3.125rem] bg-warning-500 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:i||0})]}),(0,r.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,r.jsx)("p",{className:"footer-text",children:"Maxsulot turlari :"}),(0,r.jsx)("span",{className:"block rounded-[3.125rem] bg-success-400 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:c||0})]})]}),(0,r.jsx)("div",{className:"category-card-checkmark",children:(0,r.jsx)(n.jI1,{size:"1rem",className:"check-icon"})})]})}},5692:function(e,t,a){a.d(t,{Z:function(){return v}});var n=a(71),r=(a(2791),a(184)),i=function(e){var t=e.onClick,a=e.text,i=e.type,c=e.active,l={cash:(0,r.jsx)(n.OR0,{className:"paymentsstyle",size:"1.3125rem"}),card:(0,r.jsx)(n.RjO,{className:"paymentsstyle",size:"1.3125rem"}),transfer:(0,r.jsx)(n.g2P,{className:"paymentsstyle",size:"1.3125rem"}),mixed:(0,r.jsx)(n.qTT,{className:"paymentsstyle",size:"1.3125rem"})};return(0,r.jsxs)("button",{onClick:function(){return t(i)},className:"salestyle ".concat(c?"bg-primary-700 text-white-900":"bg-[#E9ECEB]"),children:[l[i],a]})},c=function(e){var t=e.onClick,a=e.text,i=e.onDoubleClick;return(0,r.jsxs)("button",{onClick:t,onDoubleClick:i,className:"paymentstyle grow",children:[(0,r.jsx)(n.Q84,{className:"paystyle",size:"1.3125rem"}),a]})},l=a(9434);a(1413);var u=function(e){var t=e.value,a=e.onChange;return e.option,e.onSelect,(0,l.v9)((function(e){return e.currency})).currencyType,(0,r.jsx)("div",{className:"flex w-[11.75rem] border border-warning-500 rounded-[0.25rem] outline outline-transparent outline-0 focus-within:outline-2 focus-within:outline-warning-500 transition-all ease-in-out duration-100 relative",children:(0,r.jsx)("input",{className:"w-full placeholder-blue-200 py-[0.3125rem] px-[.3125rem] rounded-[0.25rem] outline-0 text-sm text-right transition-all ease-in-out duration-100",placeholder:"misol: 100 000 000",type:"number",value:t,onChange:function(e){a(e.target.value)},onWheel:function(e){return e.target.blur()},min:0})})},s=function(e){var t=e.value,a=e.onChange,n=e.option,i=e.onSelect,c=e.type,l=e.label;return(0,r.jsxs)("div",{className:"flex justify-between w-full items-center mb-[1rem]",children:[(0,r.jsxs)("div",{className:"text-black-700 text-[0.875rem]",children:[l,":"]}),(0,r.jsx)(u,{onChange:function(e){return a(e,c)},onSelect:i,value:t,option:n})]})},o=a(4952),d=function(e){var t=e.onClick;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{onClick:t,className:"exitbtn",children:(0,r.jsx)(n.Lp2,{size:"0.75rem"})})})};var m=function(e){var t=e.mix,a=e.value,n=e.onChange,i=e.label,c=e.onClose,l=e.keyInput,u=e.placeholder,s=e.type;return(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[i," :"]}),(0,r.jsxs)("div",{className:"flex items-center w-[11.75rem] gap-[0.625rem]",children:[(0,r.jsx)(o.Z,{placeholder:u||"misol: 100 000 000",type:s||"number",value:a,onChange:function(e){n(e.target.value,l)}}),t&&(0,r.jsx)(d,{onClick:function(){return c(l)}})]})]})},p=a(8825),b=a(7689),f=a(2932),h=a(7584);var v=function(e){var t=e.returned,a=e.active,u=e.togglePaymentModal,o=e.type,d=void 0===o?"cash":o,v=e.cash,x=void 0===v?"":v,N=e.card,g=void 0===N?"":N,y=e.transfer,Z=void 0===y?"":y,k=e.discount,j=e.discountUzs,z=e.hasDiscount,S=e.debt,C=e.allPayment,U=e.allPaymentUzs,w=e.paid,P=void 0===w?0:w,_=e.client,D=void 0===_?"":_,M=e.onChange,T=e.onClose,X=e.changePaymentType,F=e.discountSelectOption,q=(e.handleClickDiscountBtn,e.handleChangeDiscountSelectOption),O=e.handleChangeDiscount,I=(e.exchangerate,e.handleClickPay),E=e.allMainPayment,H=e.saleComment,Q=e.changeComment,L=e.onDoubleClick,V=e.paymentUsd,Y=void 0===V?"":V,B=e.debtuzs,J=e.debtType,R=e.setDebtType,K=(0,b.TH)(),W=function(){switch(d){case"card":return(0,r.jsx)(m,{value:g,keyInput:d,onChange:M,onClose:T,label:(0,p.t)("Plastik")},"sale-card1");case"transfer":return(0,r.jsx)(m,{value:Z,keyInput:d,onChange:M,onClose:T,label:(0,p.t)("O`tkazma")},"sale-transfer");case"mixed":return[{label:(0,p.t)("USD"),key:"usd",value:Y},{label:(0,p.t)("Naqd"),key:"cash",value:x},{label:(0,p.t)("Plastik"),key:"card",value:g},{label:(0,p.t)("O`tkazma"),key:"transfer",value:Z}].map((function(e){return(0,r.jsx)(m,{value:e.value,keyInput:e.key,onChange:M,onClose:T,label:(0,p.t)(e.label)},"sale-".concat(e.key))}));default:return K.pathname.includes("/kassa/debts")?"sum"===J?(0,r.jsx)(m,{value:x,onChange:M,keyInput:d,onClose:T,label:(0,p.t)("Naqd")},"sale-cash"):(0,r.jsx)(m,{value:Y,onChange:M,keyInput:"usd",onClose:T,label:(0,p.t)("USD")},"sale-usd"):(0,r.jsxs)(r.Fragment,{children:["mixed"!==d&&(0,r.jsx)(m,{value:Y,onChange:M,keyInput:"usd",onClose:T,label:(0,p.t)("USD")},"sale-usd"),(0,r.jsx)(m,{value:x,onChange:M,keyInput:d,onClose:T,label:(0,p.t)("Naqd")},"sale-cash")]})}},A=(0,l.v9)((function(e){return e.currency})),$=A.currencyType;return A.currency,(0,r.jsxs)("section",{className:"absolute transition-all left-0 top-0 right-0 bottom-0 overflow-hidden duration-200 ease-out bg-black-300 backdrop-blur-[3px] z-20 ".concat(a?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),onClick:u,children:[(0,r.jsx)("h3",{className:"text-white-900 text-lg leading-[1.875rem absolute top-[50%] left-[35%] -translate-x-[50%]",children:(0,p.t)("Oynani yopish uchun bu yerga bosing !")}),(0,r.jsxs)("div",{className:"customerPay-head-style transition-all duration-200 ease-linear h-full overflow-auto absolute top-0 bottom-0 right-0 ".concat(a?"translate-x-0":"translate-x-full"),onClick:function(e){return e.stopPropagation()},autoFocus:!0,children:[(0,r.jsxs)("div",{className:"top-payment w-full",children:[D&&(0,r.jsxs)("div",{className:"customer-head-icon",children:[(0,r.jsxs)("div",{className:"flex items-center custom-payment-text-style",children:[(0,r.jsx)(n.J4e,{className:"mr-[0.75rem]"}),(0,r.jsxs)("span",{children:[(0,p.t)("Mijoz")," : "]})]}),(0,r.jsx)("h3",{className:"text-[0.875rem]",children:D})]}),(0,r.jsx)("div",{className:"mb-[1.25rem] font-medium text-[1.25rem] text-center leading-[23.44px]",children:K.pathname.includes("/kassa/debts")?"dollar"===J?C+" USD":U+" UZS":Number(E)+" UZS"}),(0,r.jsxs)("ul",{className:"w-full pb-[1.25rem]",children:[!t&&W(),(K.pathname.includes("/kassa/debts")||K.pathname.includes("/qarzdorlar")||K.pathname.includes("/maxsulotlar/qabul/qabulqilish")||K.pathname.includes("/maxsulotlar/qabul/qabullar"))&&W(),(0,r.jsx)(m,{value:H,keyInput:d,onChange:Q,onClose:T,label:(0,p.t)("Izoh"),placeholder:(0,p.t)("misol: qarzga olindi"),type:"text"},"sale-card"),z&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{value:k,onChange:O,option:F,onSelect:q,label:"Chegirma USD",type:"usd"}),(0,r.jsx)(s,{value:j,onChange:O,option:F,onSelect:q,label:"Chegirma UZS",type:"uzs"})]}),K.pathname.includes("/kassa/debts")?"sum"===J?(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[(0,p.t)("Qarzlar")," :"," "]}),(0,r.jsxs)("h3",{className:"text-error-500 text-[1rem]",children:[B," UZS"]})]}):(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[(0,p.t)("Qarzlar")," :"," "]}),(0,r.jsxs)("h3",{className:"text-error-500 text-[1rem]",children:[(0,h.Y2)(S)," USD ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]})]}):(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[(0,p.t)("Qarzlar")," :"," "]}),(0,r.jsxs)("h3",{className:"text-error-500 text-[1rem]",children:[Math.round(1e3*S)/1e3," USD ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),B," UZS"]})]}),K.pathname.includes("/kassa/debts")&&(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[(0,p.t)("Qarz")," :"," "]}),(0,r.jsxs)("h3",{className:"text-error-500 text-[1rem] flex items-center gap-2",children:[(0,r.jsx)(f.Z,{id:"debt",onChange:function(){return R("dollar")},value:"dollar"===J,label:(0,p.t)("USD")}),(0,r.jsx)(f.Z,{id:"debt2",onChange:function(){return R("sum")},value:"sum"===J,label:(0,p.t)("UZS")})]})]}),(0,r.jsxs)("li",{className:"custom-payment-ul-li",children:[(0,r.jsxs)("span",{className:"custom-payment-text-style",children:[C<0?(0,p.t)("Qaytarilayotgan"):(0,p.t)("To`lanayotgan")," ",":"," "]}),(0,r.jsxs)("h3",{className:"text-[1rem] text-loginButton",children:[P.toLocaleString("ru-Ru")," ",$]})]})]})]}),(0,r.jsxs)("div",{className:"bottom-payment w-full flex flex-col gap-[1.25rem] border-t-[1px] border-black-200 pt-[1.25rem]",children:[(0,r.jsxs)("div",{className:"custom-paymet-btn",children:[(0,r.jsx)(i,{text:(0,p.t)("Naqd"),type:"cash",active:"cash"===d,onClick:X}),(0,r.jsx)(i,{text:(0,p.t)("Plastik"),type:"card",active:"card"===d,onClick:X}),(0,r.jsx)(i,{text:(0,p.t)("O'tkazma"),type:"transfer",active:"transfer"===d,onClick:X}),!t&&(0,r.jsx)(i,{text:(0,p.t)("Aralash"),type:"mixed",active:"mixed"===d,onClick:X})]}),(0,r.jsx)(c,{text:(0,p.t)("To'lash"),onClick:I,onDoubleClick:L})]})]})]})}},5668:function(e,t,a){var n=(0,a(1608).ZP)("http://45.81.227.123/"),r=JSON.parse(localStorage.getItem("userData"));n.auth={token:r.token,market:r.market},t.Z=n},3940:function(e,t,a){a.r(t);var n=a(4165),r=a(5861),i=a(1413),c=a(3433),l=a(9439),u=a(2791),s=a(2932),o=a(8063),d=a(4339),m=a(9434),p=a(71),b=a(602),f=a(1295),h=a(4232),v=a(9732),x=a(6113),N=a(7177),g=a(2594),y=a(2230),Z=a(7584),k=a(2106),j=a(5692),z=a(7689),S=a(7129),C=a(3168),U=a(763),w=a(5668),P=a(8862),_=a(7472),D=a(184);t.default=function(){var e=(0,C.$)(["common"]),t=e.t,a=(0,m.I0)(),M=(0,z.s0)(),T=(0,z.TH)(),X=(0,m.v9)((function(e){return e.login})),F=X.user,q=X.market,O=(0,m.v9)((function(e){return e.currency})),I=O.currencyType,E=O.currency,H=(0,m.v9)((function(e){return e.category})),Q=H.allcategories,L=H.loading,V=(0,m.v9)((function(e){return e.registerSelling})),Y=V.allProducts,B=V.clients,J=V.loadingMakePayment,R=V.lastPayments,K=(0,m.v9)((function(e){return e.clients})),W=K.packmans,A=(0,u.useState)([]),$=(0,l.Z)(A,2),G=$[0],ee=$[1],te=(0,u.useState)(""),ae=(0,l.Z)(te,2),ne=ae[0],re=ae[1],ie=(0,u.useState)(!1),ce=(0,l.Z)(ie,2),le=ce[0],ue=ce[1],se=(0,u.useState)([]),oe=(0,l.Z)(se,2),de=oe[0],me=oe[1],pe=(0,u.useState)(Q),be=(0,l.Z)(pe,2),fe=be[0],he=be[1],ve=(0,u.useState)(null),xe=(0,l.Z)(ve,2),Ne=xe[0],ge=xe[1],ye=(0,u.useState)(""),Ze=(0,l.Z)(ye,2),ke=Ze[0],je=Ze[1],ze=(0,u.useState)([]),Se=(0,l.Z)(ze,2),Ce=Se[0],Ue=Se[1],we=(0,u.useState)(""),Pe=(0,l.Z)(we,2),_e=Pe[0],De=Pe[1],Me=(0,u.useState)([]),Te=(0,l.Z)(Me,2),Xe=Te[0],Fe=Te[1],qe=(0,u.useState)(""),Oe=(0,l.Z)(qe,2),Ie=Oe[0],Ee=Oe[1],He=(0,u.useState)(""),Qe=(0,l.Z)(He,2),Le=Qe[0],Ve=Qe[1],Ye=(0,u.useState)(!1),Be=(0,l.Z)(Ye,2),Je=Be[0],Re=Be[1],Ke=(0,u.useState)(null),We=(0,l.Z)(Ke,2),Ae=We[0],$e=We[1],Ge=(0,u.useState)(!1),et=(0,l.Z)(Ge,2),tt=et[0],at=et[1],nt=(0,u.useState)("cash"),rt=(0,l.Z)(nt,2),it=rt[0],ct=rt[1],lt=(0,u.useState)(""),ut=(0,l.Z)(lt,2),st=ut[0],ot=ut[1],dt=(0,u.useState)(""),mt=(0,l.Z)(dt,2),pt=mt[0],bt=mt[1],ft=(0,u.useState)(""),ht=(0,l.Z)(ft,2),vt=ht[0],xt=ht[1],Nt=(0,u.useState)(""),gt=(0,l.Z)(Nt,2),yt=gt[0],Zt=gt[1],kt=(0,u.useState)(""),jt=(0,l.Z)(kt,2),zt=jt[0],St=jt[1],Ct=(0,u.useState)(""),Ut=(0,l.Z)(Ct,2),wt=Ut[0],Pt=Ut[1],_t=(0,u.useState)(""),Dt=(0,l.Z)(_t,2),Mt=Dt[0],Tt=Dt[1],Xt=(0,u.useState)(""),Ft=(0,l.Z)(Xt,2),qt=Ft[0],Ot=Ft[1],It=(0,u.useState)(""),Et=(0,l.Z)(It,2),Ht=Et[0],Qt=Et[1],Lt=(0,u.useState)(""),Vt=(0,l.Z)(Lt,2),Yt=Vt[0],Bt=Vt[1],Jt=(0,u.useState)(""),Rt=(0,l.Z)(Jt,2),Kt=Rt[0],Wt=Rt[1],At=(0,u.useState)(!1),$t=(0,l.Z)(At,2),Gt=$t[0],ea=$t[1],ta=(0,u.useState)({label:"%",value:"%"}),aa=(0,l.Z)(ta,2),na=aa[0],ra=aa[1],ia=(0,u.useState)(0),ca=(0,l.Z)(ia,2),la=ca[0],ua=ca[1],sa=(0,u.useState)(0),oa=(0,l.Z)(sa,2),da=oa[0],ma=oa[1],pa=(0,u.useState)(0),ba=(0,l.Z)(pa,2),fa=ba[0],ha=ba[1],va=(0,u.useState)(0),xa=(0,l.Z)(va,2),Na=xa[0],ga=xa[1],ya=(0,u.useState)(0),Za=(0,l.Z)(ya,2),ka=Za[0],ja=Za[1],za=(0,u.useState)(0),Sa=(0,l.Z)(za,2),Ca=Sa[0],Ua=Sa[1],wa=(0,u.useState)(""),Pa=(0,l.Z)(wa,2),_a=Pa[0],Da=Pa[1],Ma=(0,u.useState)(null),Ta=(0,l.Z)(Ma,2),Xa=Ta[0],Fa=Ta[1],qa=(0,u.useState)(null),Oa=(0,l.Z)(qa,2),Ia=Oa[0],Ea=Oa[1],Ha=(0,u.useState)(null),Qa=(0,l.Z)(Ha,2),La=Qa[0],Va=Qa[1],Ya=(0,u.useState)([]),Ba=(0,l.Z)(Ya,2),Ja=Ba[0],Ra=Ba[1],Ka=(0,u.useState)([]),Wa=(0,l.Z)(Ka,2),Aa=Wa[0],$a=Wa[1],Ga=(0,u.useState)([]),en=(0,l.Z)(Ga,2),tn=en[0],an=en[1],nn=(0,u.useState)(0),rn=(0,l.Z)(nn,2),cn=rn[0],ln=rn[1],un=(0,u.useState)(0),sn=(0,l.Z)(un,2),on=sn[0],dn=sn[1],mn=(0,u.useState)(0),pn=(0,l.Z)(mn,2),bn=pn[0],fn=pn[1],hn=(0,u.useState)(0),vn=(0,l.Z)(hn,2),xn=vn[0],Nn=vn[1],gn=(0,u.useState)(E),yn=(0,l.Z)(gn,2),Zn=yn[0],kn=yn[1],jn=(0,u.useState)(""),zn=(0,l.Z)(jn,2),Sn=zn[0],Cn=zn[1],Un=(0,u.useState)([]),wn=(0,l.Z)(Un,2),Pn=wn[0],_n=wn[1],Dn=(0,u.useState)(!1),Mn=(0,l.Z)(Dn,2),Tn=Mn[0],Xn=Mn[1],Fn=(0,u.useState)("sum"),qn=(0,l.Z)(Fn,2),On=qn[0],In=qn[1],En=(0,u.useState)({label:q.name,value:q._id}),Hn=(0,l.Z)(En,2),Qn=Hn[0],Ln=Hn[1],Vn=null,Yn=[{title:"\u2116"},{title:t("Filial")},{title:t("Qoldiq")},{title:t("Nomi")},{title:t("Soni")},{title:t("Narxi")},{title:t("Jami"),styles:"w-[8rem]"},{title:""},{title:""}],Bn=[{title:"\u2116"},{title:t("Kodi")},{title:t("Nomi")},{title:t("Soni")},{title:t("Jami")},{title:t("Soni")},{title:t("Jami")}],Jn=function(e){at(e?!tt:e),ct("cash"),ea(!1),Ot(""),Qt(""),Bt(""),ua(0),ma(0),ra({label:"%",value:"%"})},Rn=function(e){return Math.round(1e4*e)/1e4},Kn=function(e){return Math.round(e)},Wn=function(e,t){kn(Kn(e/t))},An=function(e){ot(""),bt(""),Zt(""),St(""),Pt(""),Tt(""),xt(""),ua(0),ma(0),ja(0),Ua(0),me([]),Ee(""),De(""),Ue([{label:t("Tanlang"),value:""}].concat((0,c.Z)((0,U.map)((0,c.Z)(W),(function(e){return{value:e._id,label:e.name}}))))),Fe([{label:t("Barchasi"),value:""}].concat((0,c.Z)((0,U.map)((0,c.Z)(B),(function(e){return{value:e._id,label:e.name,saleconnectorid:(null===e||void 0===e?void 0:e.saleconnectorid)||null}}))))),Ve(""),ue(!1),ge(null),$e(null),je(""),Va(null),an([]),$a([]),Ra([]),fn(0),Nn(0),dn(0),ln(0),Jn(e),Ln({label:q.name,value:q._id})},$n=function(){Re(!1),setTimeout((function(){Da("")}),500)},Gn=function(){$n();var e={saleproducts:(0,U.map)(de,(function(e){if(Tn){var t=(0,i.Z)((0,i.Z)({},e),{},{pieces:Number(e.pieces)+Number(e.fromFilial),unitprice:e.tradeprice||e.unitprice,unitpriceuzs:e.tradepriceuzs||e.unitpriceuzs});return(null===t||void 0===t?void 0:t.tradeprice)&&(null===t||void 0===t||delete t.tradeprice),(null===t||void 0===t?void 0:t.tradepriceuzs)&&(null===t||void 0===t||delete t.tradepriceuzs),t}var a=(0,i.Z)((0,i.Z)({},e),{},{pieces:Number(e.pieces)+Number(e.fromFilial)});return(null===a||void 0===a?void 0:a.tradeprice)&&(null===a||void 0===a||delete a.tradeprice),(null===a||void 0===a?void 0:a.tradepriceuzs)&&(null===a||void 0===a||delete a.tradepriceuzs),a})),client:{_id:Ie?null===Ie||void 0===Ie?void 0:Ie.value:null,name:Ie?Ie.label:Le,packman:null===Ie||void 0===Ie?void 0:Ie.packman},packman:_e?{_id:_e.value,name:_e.label}:null,discount:{discount:Number(qt),discountuzs:Number(Ht),procient:Number(Yt),isProcient:!!Yt},payment:{totalprice:Number(fa),totalpriceuzs:Number(Na),type:it,cash:Number(st),cashuzs:Number(pt),card:Number(yt),carduzs:Number(zt),transfer:Number(wt),transferuzs:Number(Mt),discount:Number(qt),discountuzs:Number(Ht),usdpayment:Number(vt)},debt:{debt:Number(la),debtuzs:Number(da),debtType:On,comment:""},user:F._id,saleconnectorid:La,comment:Sn};console.log(e),a(La?(0,v._w)(e):(0,v.DP)(e)).then((function(e){e.payload;e.error||(An(),Xn(!1),Ia&&(a((0,x.kl)({_id:Ia._id})),Ea(null)))}))},er=function(){$n();var e={saleproducts:(0,U.filter)(Ja,(function(e){return Number(e.pieces)>0})),discounts:tn,payment:{totalprice:Number(fa),totalpriceuzs:Number(Na),type:it,cash:Number(Na<0?-1*st:st),cashuzs:Number(Na<0?-1*pt:pt),card:Number(Na<0?-1*yt:yt),carduzs:Number(Na<0?-1*zt:zt),transfer:Number(Na<0?-1*wt:wt),transferuzs:Number(Na<0?-1*Mt:Mt),usdpayment:Number(fa<0?-1*vt:vt)},debt:{debt:Number(fa<0?-1*la:la),debtuzs:Number(Na<0?-1*da:da),comment:""},user:F._id,saleconnectorid:La,comment:Sn};a((0,v.kv)(e)).then((function(e){var t=e.payload;e.error||(Fa(t),setTimeout((function(){Da("checkSellReturn"),Re(!0),An()}),500))}))},tr=function(e,t){if(de.some((function(t,a){return a===e&&!t.packcount})))return(0,k.rX)();if(de.some((function(t,a){return a===e&&(null===t||void 0===t?void 0:t.packcount)>t.total})))return(0,k.rX)();var a=(0,U.map)(de,(function(t,a){return a===e?(0,i.Z)((0,i.Z)({},t),{},{totalpackcount:!(null!==t&&void 0!==t&&t.isPackcount)&&t.total/t.packcount/100*100,isPackcount:!(null!==t&&void 0!==t&&t.isPackcount),totalprice:null!==t&&void 0!==t&&t.isPackcount?t.unitprice:Rn((null===t||void 0===t?void 0:t.packcount)*(Tn&&t.tradeprice||t.unitprice)),totalpriceuzs:null!==t&&void 0!==t&&t.isPackcount?t.unitpriceuzs:Kn((null===t||void 0===t?void 0:t.packcount)*(Tn&&t.tradepriceuzs||t.unitpriceuzs)),packcountpieces:1,pieces:null!==t&&void 0!==t&&t.isPackcount?1:t.packcount}):t}));me(a)},ar=function(e){Ne===e?ge(null):(ge(e),je(""),he(Q))},nr=function(e){!e.barcode&&re(e);var t=e.barcode?Y.find((function(t){return t.productdata.barcode===e.barcode})):Y.find((function(t){return t._id===e.value})),a={total:t.total,product:{_id:t._id,code:t.productdata.code,name:t.productdata.name,barcode:t.productdata.barcode},totalprice:t.price.sellingprice,totalpriceuzs:t.price.sellingpriceuzs,tradeprice:t.price.tradeprice||0,tradepriceuzs:t.price.tradepriceuzs||0,pieces:1,isUsd:(null===t||void 0===t?void 0:t.isUsd)||!1,incomingprice:t.price.incomingprice,incomingpriceuzs:t.price.incomingpriceuzs,unitprice:t.price.sellingprice,unitpriceuzs:t.price.sellingpriceuzs,categorycode:t.category.code,filialProductsTotal:t.total,fromFilial:0,filial:q._id,packcount:null===t||void 0===t?void 0:t.packcount};"USD"===I&&a.incomingprice<=a.unitprice||"UZS"===I&&a.incomingpriceuzs<=a.unitpriceuzs?(me([].concat((0,c.Z)(de),[a])),re("")):(0,k.zX)()},rr=function(e,t){var a=Tn?(0,U.map)(de,(function(a,n){return n===e?(0,i.Z)((0,i.Z)({},a),{},{tradeprice:a.isUsd?t:(0,Z.Nt)(t,Zn),tradepriceuzs:a.isUsd?(0,Z.uX)(t,Zn):t,totalprice:a.isUsd?t*Number(a.pieces):(0,Z.Nt)(t*Number(a.pieces),Zn),totalpriceuzs:a.isUsd?(0,Z.uX)(t*Number(a.pieces),Zn):t*Number(a.pieces)}):a})):(0,U.map)(de,(function(a,n){return n===e?(0,i.Z)((0,i.Z)({},a),{},{unitprice:a.isUsd?t:(0,Z.Nt)(t,Zn),unitpriceuzs:a.isUsd?(0,Z.uX)(t,Zn):t,totalprice:a.isUsd?t*Number(a.pieces):(0,Z.Nt)(t*Number(a.pieces),Zn),totalpriceuzs:a.isUsd?(0,Z.uX)(t*Number(a.pieces),Zn):t*Number(a.pieces)}):a}));me(a)},ir=function(e,t){var a=(0,U.map)(de,(function(a,n){return n===e?(0,i.Z)((0,i.Z)({},a),{},{pieces:null!==a&&void 0!==a&&a.isPackcount?Number(t)*(null===a||void 0===a?void 0:a.packcount):t,packcountpieces:null!==a&&void 0!==a&&a.isPackcount?Number(t):0,totalprice:Rn((null!==a&&void 0!==a&&a.isPackcount?Number(t)*(null===a||void 0===a?void 0:a.packcount):Number(t))*(Tn&&a.tradeprice||a.unitprice)),totalpriceuzs:Kn((null!==a&&void 0!==a&&a.isPackcount?Number(t)*(null===a||void 0===a?void 0:a.packcount):Number(t))*(Tn&&a.tradepriceuzs||a.unitpriceuzs))}):a}));me(a)},cr=function(e,t){var a=(0,U.map)(de,(function(a){return a.product._id===e?(0,i.Z)((0,i.Z)({},a),{},{fromFilial:Number(t),totalprice:Rn((Number(t)+Number(a.pieces))*(Tn&&a.tradeprice||a.unitprice)),totalpriceuzs:Kn((Number(t)+Number(a.pieces))*(Tn&&a.tradepriceuzs||a.unitpriceuzs))}):a}));me(a)},lr=function(e,t){ur(t).then((function(a){me((0,c.Z)(de).map((function(n){return n.product._id===e&&(n.filialProductsTotal=a.total,n.filial=t.filial,t.filial===q._id&&(n.fromFilial=0,n.totalprice=Rn(Number(n.pieces)*(Tn&&n.tradeprice||n.unitprice)),n.totalpriceuzs=Kn(Number(n.pieces)*(Tn&&n.tradepriceuzs||n.unitpriceuzs)))),n})))})).catch((function(e){return(0,k.Ug)(e,"error")}))},ur=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.Z.post("/filials/products/get",t);case 2:return a=e.sent,r=a.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){var e=[],t=[];q&&w.Z.emit("getProductsOfCount",{market:q._id}),q&&w.Z.on("categories",(function(e){var t=e.id,n=e.categories;t===q._id&&a((0,P.um)(n))})),q&&w.Z.on("getProductsOfCount",(function(n){var r=n.id,i=n.products;r===q._id&&(t=[].concat((0,c.Z)(t),(0,c.Z)((0,U.map)(i,(function(e){var t,a;return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name," -------- (").concat(null!==e&&void 0!==e&&e.isUsd?(null===e||void 0===e||null===(t=e.price)||void 0===t?void 0:t.sellingprice).toLocaleString("ru-RU"):(null===e||void 0===e||null===(a=e.price)||void 0===a?void 0:a.sellingpriceuzs).toLocaleString("ru-RU")," ").concat(null!==e&&void 0!==e&&e.isUsd?"USD":"UZS",")")}})))),ee(t),e.push.apply(e,(0,c.Z)(i)),a((0,v.r5)(e)))})),q&&w.Z.on("error",(function(e){var t=e.id,a=e.message;t===q._id&&(0,k.Ug)(a,"error")}))}),[q,a,R]),(0,u.useEffect)((function(){if(Ne){var e=(0,U.filter)(Y,(function(e){return e.category._id===Ne}));ee((0,U.map)(e,(function(e){return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}})))}else ee((0,U.map)(Y,(function(e){return{value:e._id,label:"(".concat(e.total,") ").concat(e.category.code).concat(e.productdata.code," - ").concat(e.productdata.name)}})))}),[Ne]),(0,u.useEffect)((function(){a((0,N.Im)()),a((0,v.ZL)()),a((0,v.LY)({marketData:q}))}),[a,q]),(0,u.useEffect)((function(){he(Q)}),[Q]),(0,u.useEffect)((function(){Ue([{label:t("Tanlang"),value:""}].concat((0,c.Z)((0,U.map)((0,c.Z)(W),(function(e){return{value:e._id,label:e.name}})))))}),[W,t]),(0,u.useEffect)((function(){Fe([{label:t("Barchasi"),value:""}].concat((0,c.Z)((0,U.map)((0,c.Z)(B),(function(e){return{value:e._id,label:e.name,saleconnectorid:(null===e||void 0===e?void 0:e.saleconnectorid)||null}})))))}),[B,t]),(0,u.useEffect)((function(){var e,t=T.state,a=function(){t.saleconnector.client&&Ee({label:t.saleconnector.client.name,value:t.saleconnector.client._id}),t.saleconnector.packman&&De({label:t.saleconnector.packman.name,value:t.saleconnector.packman._id}),Va(t.saleconnector._id)};t&&t.temporary&&(console.log(t.temporary),Ea(t.temporary),me(t.temporary.tableProducts),Va((null===(e=t.temporary.clientValue)||void 0===e?void 0:e.saleconnectorid)||null),Ee(t.temporary.clientValue),De(t.temporary.packmanValue),Ve(t.temporary.userValue));if(t&&t.saleconnector&&!t.returnProducts&&a(),t&&t.saleconnector&&t.returnProducts){a();var n=[];(0,U.map)(t.saleconnector.products,(function(e){var t={_id:e.product._id,isUsd:e.product.isUsd,discount:e.discount&&e.discount,pieces:e.pieces,totalprice:e.totalprice,totalpriceuzs:e.totalpriceuzs};return(0,U.map)(e.saleproducts,(function(e){return t.pieces+=e.pieces,t.totalprice+=e.totalprice,t.totalpriceuzs+=e.totalpriceuzs,""})),e.pieces>0&&n.push({pieces:"",totalpriceuzs:0,totalprice:0,unitprice:e.unitprice,unitpriceuzs:e.unitpriceuzs,product:(0,i.Z)({},t),productdata:(0,i.Z)({},e.product.productdata),_id:e._id}),""})),Ra((0,U.filter)(n,(function(e){return e.product.pieces>0}))),$a((0,c.Z)(t.saleconnector.discounts));ln(t.saleconnector.products.reduce((function(e,t){return e+(t.product.isUsd?t.totalprice:0)}),0)),dn(t.saleconnector.products.reduce((function(e,t){return e+(t.product.isUsd?0:t.totalpriceuzs)}),0)),fn(t.saleconnector.payments.reduce((function(e,t){return e+(t.usdpayment?t.usdpayment:0)}),0)),Nn(t.saleconnector.payments.reduce((function(e,t){return e+(t.paymentuzs||0)}),0))}window.history.replaceState({},document.title)}),[T.state]),(0,D.jsxs)("div",{className:"flex grow relative overflow-auto",children:[J&&(0,D.jsx)("div",{className:"fixed backdrop-blur-[2px] z-[100] left-0 top-0 right-0 bottom-0 bg-white-700 flex flex-col items-center justify-center w-full h-full",children:(0,D.jsx)(h.Z,{})}),(0,D.jsx)(j.Z,{returned:!!Ja.length,exchangerate:Zn,type:it,active:tt,allMainPayment:Kt,togglePaymentModal:Jn,changePaymentType:function(e){var t=fa-Number(qt),a=Na-Number(Ht),n=Ja.reduce((function(e,t){return Rn(e+t.totalprice)}),0),r=Ja.reduce((function(e,t){return Kn(e+t.totalpriceuzs)}),0),i=Rn(cn-bn-n),c=Kn(on-xn-r);if(it!==e)switch(ct(e),e){case"cash":Ja.length>0?i<=0?(ha(i),ga(c),ot(Math.abs(i)),bt(Math.abs(c)),ja(Math.abs(i)),Ua(Math.abs(c))):(ot(0),bt((0,Z.uX)(0,Zn)),ua(Rn(i)),ma(Kn(c)),ha(n),ga(r),ja(n),Ua(r)):(ot(t),bt(a),Zt(""),St(""),Pt(""),Tt(""),ja(t),Ua(a),ua(0),ma(0));break;case"card":Ja.length>0?i<=0?(ha(i),ga(c),Zt(Math.abs(i)),St(Math.abs(c)),ja(Math.abs(i)),Ua(Math.abs(c))):(Zt(0),St((0,Z.uX)(0,Zn)),ua(Rn(i)),ma(Kn(c)),ha(n),ga(r),ja(n),Ua(r)):(Zt(t),St(a),ot(""),bt(""),Pt(""),Tt(""),ja(t),Ua(a),ua(0),ma(0)),ot(""),bt(""),Pt(""),Tt("");break;case"transfer":Ja.length>0?i<=0?(ha(i),ga(c),Pt(Math.abs(i)),Tt(Math.abs(c)),ja(Math.abs(i)),Ua(Math.abs(c))):(Pt(0),Tt((0,Z.uX)(0,Zn)),ua(Rn(i)),ma(Kn(c)),ha(n),ga(r),ja(n),Ua(r)):(Pt(t),Tt(a),ot(""),bt(""),Zt(""),St(""),ja(t),Ua(a),ua(0),ma(0)),ot(""),bt(""),Zt(""),St("");break;default:ot(""),bt(""),Zt(""),St(""),Pt(""),Tt(""),ja(0),Ua(0),xt(""),ua(fa-Number(qt)),ma(Na-Number(Ht))}},onChange:function(e,t){!function(e,t){var a=Math.abs(fa),n=Math.abs(Na);if("USD"===I)if("cash"===t){var r=Number(e)+Number(vt),i=Number((0,Z.uX)(e,Zn))+Number((0,Z.uX)(vt,Zn));r<=a?(ot(e),bt((0,Z.uX)(e,Zn)),ua(Rn(a-r)),ma(Kn(n-i)),ja(r),Ua(i)):(0,k.bH)()}else if("usd"===t){var c=Number(e)+Number(st),l=Number((0,Z.uX)(e,Zn))+Number(pt);c<=a?(ua(Rn(a-c)),ma(Kn(n-l)),ja(c),Ua(l),xt(e)):(0,k.bH)()}else if("card"===t){var u=Number(e)+Number(st)+Number(wt),s=Number(pt)+Number((0,Z.uX)(e,Zn))+Number(Mt);u<=a?(Zt(e),St((0,Z.uX)(e,Zn)),ua(Rn(a-u)),ma(Kn(n-s)),ja(u),Ua(s)):(0,k.bH)()}else{var o=Number(e)+Number(st)+Number(yt),d=Number(pt)+Number(zt)+Number((0,Z.uX)(e,Zn));o<=a?(Pt(e),Tt((0,Z.uX)(e,Zn)),ua(Rn(a-o)),ma(Kn(n-d)),ja(o),Ua(d)):(0,k.bH)()}else if("cash"===t){var m=Number(e)+Number(Mt)+Number(zt),p=Number((0,Z.Nt)(e,Zn))+Number(wt)+Number(yt);bt(e),ot(Rn((0,Z.Nt)(e,Zn))),ja(p),Ua(m),m<=n?ma(n-(vt>a?(0,Z.uX)(vt-a,Zn):0)-m):(ma(0),xt(Rn(a-(0,Z.Nt)(m-n,Zn))),ua(0))}else if("usd"===t){var b=Number(pt)+Number(Mt)+Number(zt),f=Number(e);ja(f),xt(e),f<=a?ua(a-(b>n?(0,Z.Nt)(b-n,Zn):0)-f):(ma(0),bt(n-(0,Z.uX)(f-a,Zn)),ot((0,Z.Nt)(n-(0,Z.uX)(f-a,Zn),Zn)),ua(0))}else if("card"===t){var h=Number(e)+Number(pt)+Number(Mt),v=Number(st)+Number((0,Z.Nt)(e,Zn))+Number(wt);St(e),Zt((0,Z.Nt)(e,Zn)),ja(v),Ua(h),h<=n?ma(n-(vt>a?(0,Z.uX)(vt-a,Zn):0)-h):(ma(0),xt(Rn(a-(0,Z.Nt)(h-n,Zn))),ua(0))}else{var x=Number(e)+Number(pt)+Number(zt),N=Number(st)+Number(yt)+Number((0,Z.Nt)(e,Zn));Tt(e),Pt((0,Z.Nt)(e,Zn)),ja(N),Ua(x),x<=n?ma(n-(vt>a?(0,Z.uX)(vt-a,Zn):0)-x):(ma(0),xt(Rn(a-(0,Z.Nt)(x-n,Zn))),ua(0))}}(e,t)},client:Le||Ie.label||_e.label,allPayment:fa,allPaymentUzs:Na,card:"USD"===I?yt:zt,cash:"USD"===I?st:pt,debt:la,debtuzs:da,discount:qt,discountUzs:Ht,handleChangeDiscount:function(e,t){if("usd"===t){var a=Math.round(1e4*e)/1e4;Bt(e),Ot(a),Ua(Kt-(0,Z.uX)(a,Zn)-Number(Ht))}else{var n=Math.round(1*e)/1;Bt(e),Qt(n),Ua(Kt-n-Number((0,Z.uX)(qt,Zn)))}ot(""),bt(""),Zt(""),St(""),Pt(""),Tt(""),ua(""),ma(""),xt("")},hasDiscount:Gt,transfer:"USD"===I?wt:Mt,handleClickDiscountBtn:function(){ea(!Gt),Ot(""),Qt(""),Bt("")},discountSelectOption:na,handleChangeDiscountSelectOption:function(e){na.value!==e.value&&(ra(e),Ot(""),Qt(""),Bt(""),ot(""),bt(""),Zt(""),St(""),Pt(""),Tt(""),ua(fa),ma(Na),ja(0),Ua(0))},paid:"USD"===I?ka:Ca,handleClickPay:function(){null===Vn&&(Vn=window.setTimeout((function(){Vn=null,Da("complete"),Re(!0)}),300))},changeComment:function(e){Cn(e)},saleComment:Sn,onDoubleClick:function(){window.clearTimeout(Vn),Vn=null,Ja.length>0?er():Gn()},paymentUsd:vt,debtType:On,setDebtType:In}),(0,D.jsx)(y.Z,{body:_a,toggleModal:"complete"===_a?$n:function(){Re(!Je),Da(""),Fa(null)},approveFunction:"complete"===_a?Ja.length?er:Gn:function(){},isOpen:Je,product:Xa,headers:Yn,headerText:"complete"===_a&&t("To'lovni amalga oshirishni tasdiqlaysizmi ?"),title:"complete"===_a&&t("To'lovni amalga oshirgach bu ma`lumotlarni o`zgaritirb bo`lmaydi !"),changeProduct:function(e,t){switch(t){case"unitprice":!function(e){$e((0,i.Z)((0,i.Z)({},Ae),{},{unitprice:"USD"===I?e:(0,Z.Nt)(e,Zn),unitpriceuzs:"UZS"===I?e:(0,Z.uX)(e,Zn),totalprice:"USD"===I?e*Ae.pieces:(0,Z.Nt)(e*Ae.pieces,Zn),totalpriceuzs:"UZS"===I?e*Ae.pieces:(0,Z.uX)(e*Ae.pieces,Zn)}))}(e);break;case"pieces":!function(e){$e((0,i.Z)((0,i.Z)({},Ae),{},{pieces:e,totalprice:e*Ae.unitprice,totalpriceuzs:e*Ae.unitpriceuzs}))}(e);break;default:return null}}}),(0,D.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem] overflow-auto",children:[(0,D.jsxs)("div",{className:"mainPadding flex flex-col gap-[1.25rem]",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)(s.Z,{id:"register-selling",onChange:function(){le&&(Ve(""),De(""),Ee("")),ue(!le)},value:le,label:t("Mijoz")}),(0,D.jsxs)("div",{className:"flex gap-[1.25rem] mt-[1rem]",children:[(0,D.jsx)(o.Z,{placeholder:t("Santexniklar"),maxWidth:"w-[14.676875rem]",disabled:!le,border:!0,select:!0,value:_e,options:Ce,onChange:function(e){De(e);var a=(0,U.filter)(W,(function(t){return t._id===e.value}))[0];a&&a.hasOwnProperty("clients")?Fe((0,U.map)(a.clients,(function(e){return{label:e.name,value:e._id,packman:a,saleconnectorid:(null===e||void 0===e?void 0:e.saleconnectorid)||null}}))):Fe([{label:t("Tanlang"),value:""}].concat((0,c.Z)((0,U.map)((0,c.Z)(B),(function(e){return{label:e.name,value:e._id,packman:null===e||void 0===e?void 0:e.packman,saleconnectorid:(null===e||void 0===e?void 0:e.saleconnectorid)||null}}))))),Ee(""),Ve("")}}),(0,D.jsx)(o.Z,{placeholder:t("Xaridor"),maxWidth:"w-[14.676875rem]",disabled:!le,border:!0,select:!0,value:Ie,options:Xe,onChange:function(e){Ee(e),Va((null===e||void 0===e?void 0:e.saleconnectorid)||null);var t,a,n=(0,U.filter)(B,(function(t){return t._id===e.value}))[0];n&&n.hasOwnProperty("packman")&&De({label:null===n||void 0===n||null===(t=n.packman)||void 0===t?void 0:t.name,value:null===n||void 0===n||null===(a=n.packman)||void 0===a?void 0:a._id});e.value?Ve(e.label):Ve("")}}),(0,D.jsx)(o.Z,{placeholder:t("Amaldagi xaridor"),disabled:!le,value:Le,onChange:function(e){Ve(e.target.value)}})]})]}),!Ja.length&&(0,D.jsxs)("div",{className:"flex flex-col gap-[1.25rem]",children:[(0,D.jsx)(o.Z,{select:!0,placeholder:t("misol: kompyuter"),value:ne,label:t("Maxsulotlar"),onChange:nr,options:G}),(0,D.jsx)("div",{className:"flex justify-end items-start",children:(0,D.jsxs)("div",{className:"checkbox-card sale-toggle-container",children:[(0,D.jsxs)("p",{className:"toggleText",children:[t("Optom narxida hisoblash")," :"]}),(0,D.jsx)("input",{type:"checkbox",checked:Tn,onChange:function(e){var t=e.target.checked;de.length>0?(Xn(!Tn),me(t?function(e){return e.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{totalprice:e.tradeprice?Rn(Number(e.pieces+e.fromFilial)*e.tradeprice):e.totalprice,totalpriceuzs:e.tradepriceuzs?Kn(Number(e.pieces+e.fromFilial)*e.tradepriceuzs):e.totalpriceuzs})}))}:function(e){return e.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{totalprice:e.unitprice?Rn(Number(e.pieces+e.fromFilial)*e.unitprice):e.totalprice,totalpriceuzs:e.unitpriceuzs?Kn(Number(e.pieces+e.fromFilial)*e.unitpriceuzs):e.totalpriceuzs})}))})):(0,k._P)()}})]})})]})]}),(0,D.jsx)("div",{className:"tableContainerPadding mt-[-20px]",children:Ja.length?(0,D.jsx)(d.Z,{page:"backproduct",data:Ja,headers:Bn,currency:I,changeHandler:function(e,a,n){if(e>Number(Ja[n].product.pieces))return(0,k.Ug)(t("Diqqat! Qaytariladigan mahsulot soni sotilgan mahsulot sonidan ortiq bo'lolmaydi"),"warning");var r=(0,U.map)(Ja,(function(t){return t._id===a?(0,i.Z)((0,i.Z)({},t),{},{pieces:e,totalprice:Rn(e*t.unitprice),totalpriceuzs:Kn(e*t.unitpriceuzs)}):t}));Ra(r)}}):de.length?(0,D.jsx)(d.Z,{page:"registersale",data:de,headers:Yn,currency:I,Delete:function(e){de.splice(e,1),me((0,c.Z)(de))},changeHandler:function(e,t,a){switch(a){case"unitprice":rr(e,t);break;case"pieces":ir(e,t);break;case"fromFilial":cr(e,t);break;case"select":lr(e,t);break;case"packcount":tr(e,t)}},footer:"registersale",increment:function(e){var t=(0,U.map)(de,(function(t){return t.product._id===e?(0,i.Z)((0,i.Z)({},t),{},{pieces:Number(t.pieces)+1,totalprice:Rn((Number(t.pieces)+Number(t.fromFilial)+1)*(Tn&&t.tradeprice||t.unitprice)),totalpriceuzs:Kn((Number(t.pieces)+Number(t.fromFilial)+1)*(Tn&&t.tradepriceuzs||t.unitpriceuzs))}):t}));me(t)},decrement:function(e){var t=(0,U.map)(de,(function(t){return t.product._id===e?(0,i.Z)((0,i.Z)({},t),{},{pieces:Number(t.pieces)>1?Number(t.pieces)-1:1,totalprice:Rn((Number(t.pieces)>1?Number(t.pieces)-1+Number(t.fromFilial):1)*(Tn&&t.tradeprice||t.unitprice)),totalpriceuzs:Kn((Number(t.pieces)>1?Number(t.pieces)-1+Number(t.fromFilial):1)*(Tn&&t.tradepriceuzs||t.unitpriceuzs))}):t}));me(t)},lowUnitpriceProducts:Pn,wholeSale:Tn,selectedFilial:Qn}):(0,D.jsx)(f.Z,{text:t("Sotuvda mahsulotlar qo'shilmagan!")})})]}),(0,D.jsxs)("div",{className:"register-selling-right min-w-[20.25rem] bg-white-400 backdrop-blur-[3.125rem] rounded-[0.25rem] flex flex-col gap-[1.25rem]",children:[(0,D.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem]",children:[(0,D.jsx)(g.Z,{placeholder:t("kategoriyani qidirish..."),value:ke,onChange:function(e){var t=e.target.value;je(t);var a=t.replace(/\s+/g," ").trim(),n=(0,U.filter)(Q,(function(e){return e.name&&e.name.toLowerCase().includes(a)||e.code.includes(a)}));he(""!==t?n:Q)},onKeyUp:function(){}}),(0,D.jsx)("div",{className:"grow relative overflow-auto",children:(0,D.jsx)("div",{className:"cards-container absolute left-0 right-[0.125rem] top-0 bottom-0",children:L?(0,D.jsx)("div",{className:"tableContainerPadding",children:(0,D.jsx)(h.Z,{})}):fe.length>0?(0,U.map)(fe,(function(e){return(0,D.jsx)(b.Z,{id:e._id,activeCategory:e._id===Ne,title:e.name,code:e.code,products:e.products.length,onClick:ar},e._id)})):(0,D.jsx)(f.Z,{text:t("Kategoriya mavjud emas")})})})]}),(0,D.jsxs)("div",{className:"flex gap-[0.625rem]",children:[(0,D.jsx)("button",{type:"button",className:"register-selling-right-accept-btn",onClick:Ja.length?function(){if(Ja.length){var e=Ja.reduce((function(e,t){return Rn(e+(null!==t&&void 0!==t&&t.product.isUsd?t.totalprice:0))}),0),t=Ja.reduce((function(e,t){return Kn(e+(null!==t&&void 0!==t&&t.product.isUsd?0:t.totalpriceuzs))}),0),a=Aa.map((function(e){var t=(0,i.Z)({},e);return(0,U.map)(Ja,(function(a){var n;return e._id===(null===(n=a.product)||void 0===n?void 0:n.discount)&&(t=(0,i.Z)((0,i.Z)({},e),{},{discount:Rn(t.discount-a.totalprice*e.procient/100),discountuzs:Kn(t.discountuzs-a.totalpriceuzs*e.procient/100),totalprice:Rn(t.totalprice-a.totalprice),totalpriceuzs:Kn(t.totalpriceuzs-a.totalpriceuzs)})),""})),(0,i.Z)({},t)})),n=a.reduce((function(e,t){return e+t.discount}),0),r=a.reduce((function(e,t){return e+t.discountuzs}),0),c=Rn(cn-bn-n-e),l=Kn(on-xn-r-t);an(a),c<0||l<0?(ha(c),ga(l),ot(Math.abs(c)),bt(Math.abs(l)),ja(Math.abs(c)),Ua(Math.abs(l)),xt(Math.abs(c))):(ot(0),xt(0),bt((0,Z.uX)(0,Zn)),ua(Rn(c)),ma(Kn(l)),ha(e),ga(t),ja(e),Ua(t)),at(!0),Wn(t,e)}else(0,k.v_)()}:function(){if(de.length){if(de.some((function(e){return 0===e.total&&0===e.fromFilial})))return(0,k.H9)();var e=de.filter((function(e){return e.unitprice<=e.incomingprice})).map((function(e){return e.product._id}));if(e.length>0)_n(e),(0,k.zX)();else{_n(e);var t=de.reduce((function(e,t){return Rn(e+t.totalprice)}),0),a=de.reduce((function(e,t){return Kn(e+t.totalpriceuzs)}),0),n=de.reduce((function(e,t){return Kn(e+(!t.isUsd&&t.totalpriceuzs||0))}),0),r=de.reduce((function(e,t){return e+(t.isUsd&&t.totalprice||0)}),0),i=de.reduce((function(e,t){return e+(!t.isUsd&&t.totalprice||0)}),0);ha((0,Z.Y2)(r)),ga(n),Wt(a),xt((0,Z.Y2)(r)),ot((0,Z.Y2)(i)),bt(n),ja((0,Z.Y2)(t)),Ua(a),at(!0),Wn(a,t)}}else E?(0,k._P)():(0,k.YQ)()},children:t("To'lov")}),!Ja.length&&(0,D.jsx)("button",{type:"button",onClick:function(){if(de.length>0){var e=de.reduce((function(e,t){return Rn(e+t.totalprice)}),0),t=de.reduce((function(e,t){return Kn(e+t.totalpriceuzs)}),0),n={temporary:{saleconnectorid:Ie.saleconnectorid||null,clientValue:Ie,packmanValue:_e,userValue:Le,tableProducts:de,totalPrice:e,totalPriceUzs:t}};a((0,v.Jk)(n)).then((function(e){e.error||(An(!1),M("/sotuv/saqlanganlar"))})),Ia&&(a((0,x.kl)({_id:Ia._id})),Ea(null))}},className:"register-selling-right-deny-btn",children:(0,D.jsx)(p.T24,{size:"1.5rem"})})]})]}),(0,D.jsx)(S.Z,{onError:function(){(0,k.Ug)(t("Mahsulot kodi o'qilmadi!"),"warning")},onScan:function(e){nr({barcode:e})}})]})}}}]);
//# sourceMappingURL=7458.18345603.chunk.js.map